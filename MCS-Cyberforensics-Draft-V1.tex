\documentclass[conference,10pt]{IEEEtran}
\usepackage{pseudocode}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{algorithm}
\usepackage[noend]{algpseudocode}
\usepackage{graphics,graphicx,subfigure,balance}
%\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
%\usepackage{authblk}
\usepackage{lipsum,adjustbox}
\usepackage{msc,amsthm}
\usepackage{xcolor}
\usepackage{framed}
%\usepackage{siunitx}
\usepackage{tikz}
\usepackage{amssymb}
\usepackage{picture}
\usepackage{eqnarray, mathtools}
\usepackage{amsfonts}
\usepackage{booktabs}
%\setlength\parindent{0pt}
\newtheorem{myHYP}{Hypothesis}
\newtheorem{lemma}{Lemma}
\newtheorem{myDef}{Definition}
\newtheorem{prob}{Research Challenge}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\begin{document}
%\title{KRAFT -- \textbf{K}ernel module d\textbf{R}iven m\textbf{A}chinery control system \textbf{F}orensics using remo\textbf{T}e memory acquisition}
\title{Empirical Evaluation of Forensics Solutions for Live Forensics on SCADA Mchinery Control Systems}
\author{\IEEEauthorblockN{Avinash Srinivasan}
\IEEEauthorblockA{
Computer and Information Sciences\\
Temple University\\Philadelphia, PA 19121\\
Email: avinash@temple.edu}
\and
\IEEEauthorblockN{Frank Ferrese}
\IEEEauthorblockA{
Naval Surface Warfare Center\\
Philadelphia, PA 19121\\
Email: frank.ferrese@navy.mil
}}
\maketitle

\begin{abstract}
Critical infrastructures, especially machinery control systems (MCS) found onboard modern U.S. Navy warships and other military systems, are affected because of their use of commercial automation solutions. Therefore, a critical requirement is building tools and techniques to support rapid, effective, and effiicient incident response and cyberforensics capabilities. MCS being mission critical, have zero-tolerance when it comes to downtime. Consequently, a forensic investigator cannot shutdown the system to capture evidentiary data. Furthermore, todays sophisticated cyber attacks are primarily executed from the memory with little evidence on the persisten storage. Therefore, live forensics seems to be the only viable solution for conducting incident response and cyberforensics since evidentary data is primarily volatile. 
%Live forensics involves performing data acquisition and analysis on a running system. This will allow for a complete and detailed analysis while the system is still up and running, therefore having little to no effect on the mission.

In this paper, we evaluate some of the most prpolar and powerful forensics tools and frameworks to determine their suitability for porting to mission critical MCS environment. We design and develop a rudimentary prototype of a live forensics framework for SCADA-MCS that can readily integrate the existing tools and techniques on to a common platform. Our prototype is designed conforming to \textit{Open Systems Architecture} (OSA) to support cross vendor and cross platform solutions. Our empirical analysis highlights the strengths and weakness of tools studied proposes other requisite capabilities for tools to support a comprahensive live forensics on SCADA-MCS.
\end{abstract}

\begin{keywords}
Confidentiality, cyber-physical systems, data leak, fieldbus, integrity, live forensics, networks, SCADA, security.
\end{keywords}

\section{Introduction}
Vulnerabilities of such MCSs with majority proprietary system components and protocols can have vulnerabilities ranging from the very basic issues such as systems without passwords or with hard-coded passwords known to everyone to configuration issues and other software bugs. 

Control systems domain has slowly yet steadily transitioned from the traditional all-analog domain to a more cyber-driven domain â€“ popularly known as the Cyber Physical Systems (CPS). Despite a rapid adoption of the new cyber-driven technology, the physical realm of the CPS is predominantly comprised of legacy and proprietary hardware. Consequently, such proprietary aspects of control systems environments present new challenges hindering the translation and integration of modern state-of-the-art forensics analysis tools and techniques into the control systems domain. 

Supervisory Control and Data Acquisition (SCADA) systems are a type of Industrial Control System (ICS) that monitor and/or control legacy systems remotely. SCADA systems typically operate on large-scale processes across multiple sites, and can be used over long distances. A SCADA system consists of one supervisory system and many slave systems. Slave systems are divided into two subcategories -- \emph{Remote Terminal Units} (RTUs), and \emph{Programmable Logic Controllers (PLCs)}. 

Originally, RTU devices only collected telemetry data, and only PLC devices possessed process control capabilities. However, current incarnations of the two products have gained enough features that the distinction is no longer meaningful. When SCADA systems were first developed, they communicated solely using the Modbus serial standard, RS485. Recently, many SCADA systems have been configured to communicate via TCP/IP instead of Modbus. This allows easier integration with existing high-bandwidth infrastructure, but introduces an array of risks of exposing system vulnerabilities to a third party and the \textit{Internet} at large.

SCADA-MCS systems were originally created to be deployed in non-networked environments. Therefore they lack of adequate security against Internet-based threats and cyber-related forensics. In recent years, SCADA systems have undergone significant technology advancement that potentially increase the risks to which they are exposed. Among these risks, one that is the most evident and crucial is its increased connectivity that could permit remote controls over the Internet, or the incorporation of general purpose tools, thus incorporating already known vulnerabilities of these.

Any cyber-attack against SCADA systems demands forensic investigation to understand the cause and effects of the intrusion or disruption on such systems. Therefore, SCADA system forensics is an essential process within the cyber-security lifecycle that not only helps to identify the cause of an incident and those responsible but to help develop and design more secure CPS and critical infrastructure systems of the future. However, a SCADA system has a critical requirement of being continuously operational and therefore a forensic investigator cannot turn off the SCADA system for data acquisition and analysis. 
\begin{table*}[!h]
\centering
\begin{tabular}{l l l l l}\toprule
\textbf{Incident} & \textbf{Year} & \textbf{Vulnerability} & \textbf{Malware} & \textbf{Attack Vector}\\\toprule
Ukrainian Power Outage & 2015 & Excel Macros & BlackEnergy & Spear Phishing\\
New York Dam & 2013 & Command \& Control & N/A & Cellular Modem\\ 
European Energy Company & 2016 & Windws Antivirus &  SFG malware & Security appliance bypass backdoor on Windows\\\bottomrule
\end{tabular}
\vspace{2mm}
\caption{Major Cyberqattacks on Control Systems}
\label{tab:ics-attacks}
\end{table*}
Current live forensic tools are typically used to acquire and examine memory from computers running either Windows or Unix. This makes them incompatible with embedded devices found on SCADA systems that have their own bespoke operating system. Additionaly, only a limited number of forensics tools have been developed for SCADA systems, with no development of tools to acquire the program code from PLCs. With direct access to the memory addresses of the PLC, PLC debugging tools have promising functionalities as a forensic tool , such as the ``Snapshot'' function that allows users to directly take values from the memory addresses of the PLC, without vendor specific software.

\subsection{Attacks on Control Systems -- Scope of the Problem}
\begin{itemize}
\item According to NCCIS/ICS-CERT~\cite{dhs-ics-cert}, the number of ICS incident reported in the United States between 2012 - 2015 are as follows -- 197 incidents (2012), 257 incidents (2013), 245 incidents (2014), 295 incidents in (2015). 

\item In July 2014, ICS customers seeking a PLC software update inadvertently downloaded a maliciously planted Trojan, dubbed Havex~\cite{havex}. The Havex Trojan scans a widely used PLC standard called open protocol communications (OPC) and is believed to gather information about vulnerabilities in the target system, as a way to test code before a larger attack. The Havex Trojan affected a German manufacturing company, a Belgium PLC VPN software company and a Swiss company that produces industrial cameras. 

\item Another 2014 cyber-attack known as the ``The Mask''~\cite{mask} was a widespread espionage malware attack targeted at government agencies, energy, oil and gas companies and research organizations. The malware intercepts all communication channels and collects vital information from the victim's machine, to facilitate the theft of private information from ICS's. 

\item In 2014, Maritime ships using global positioning systems (GPS), automatic identification systems (AIS), and electronic chart display and information system (ECDIS) were found to have uncovered serious flaws in security~\cite{sea-hack}. 
\end{itemize}



\subsection{Solution Novelty and Summary of Contributions}
The proposed solution is designed conforming to the guidelines of OSA/OSE standards. Consequently, the solution framework provides several benefits over custom and proprietary solutions. Some of the the key benefits are delineated below --
\begin{itemize}
\item Empirically measures the performance of state-of-the-art forensics tools. 
\item Empirical validation is performed in realworld SCADA-MCS settings.
\item Analyze the suitability of MCS components to support lightweight LKM based native live forensics solutions.
\item Numerous tools are compared for their performmance under the same SCADA-MCS operating conditions.
\item Analyzes the potential for combining two or more existing tools efficiently to support live forensics on SCADA-MCS.
\item Provides requisite capabilities for any of these tools -- either independently or in combination to support comprahensive live forensics on SCADA-MCS.
\end{itemize}

\begin{table}[!t]
\scriptsize
\centering
\caption{List of acronyms and notations used.}
\begin{tabular}{llll}\toprule
\textbf{Notation} & \textbf{Description}\\\toprule
%AC & Access Control\\
ADU & Application Data Unit\\
API & Application Programming Interface\\
%ARC & Architecture\\
ARM & Advanced Risk Machine\\
CPS & Cyber Physical System\\
DLL & Dynamically Link Library\\
%FSM & Finite State Machine\\
%HW & Hardware\\
%IPC & Inter Process Call\\
IR & Incident Response\\
LKM & Loadable Kernel Module\\
MCS & Machinery Control System \\
MTU & Master Terminal Unit\\
OE & Operating Environment\\
OSA & Open Systems Architecture\\
OSE & Open Systems Environment\\
PDU & Protocol Data Unit\\
PLC & Programmable Logic Controller\\
PPC & Power PC\\
RAM & Random Access Memory\\
RMFF & Rekall Memory Forensics Framework\\
%RPC & Remote Procedure Call\\
RTU & Remote Terminal Unit\\
%SW & Software\\
TSK & The Sleuth Kit\\
VMFF & Volatility Memory Forensics Framework\\
\bottomrule
\end{tabular}
\label{tab:notations}
\end{table}

\subsection{Roadmap}
The remainder of this paper is organized as follows. In section~\ref{sec:rw}, we review relevant background information and related works. Then in section~\ref{sec:sys-model}, we present the target MCS model followed by a detailed discussion on the design and implementation of the proposed prototype evaluation model in section~\ref{sec:eval}. We present results evaluating the proposed solution framework using the proposed metrics in section~\ref{sec:results}. Finally, we conclude this paper with concluding remarks with directions for future research in section~\ref{sec:conc}.

\section{Related Work}
A large portion of research in the domain of control systems forensics has focused Programmable logic controller (PLC) firmware, which provides a software-driven interface between system inputs and physically manifested outputs, is readily open to modification at the user level. PLC is a special form of microprocessor-based controller with proprietary operating system. Due to the unique architecture of PLC, traditional digital forensic tools are difficult to be applied. 

In~\cite{yau2015plc}, authors propose a program called \textit{Control Program Logic Change Detector} (CPLCD), which works with a set of \textit{Detection Rules} (DRs) to detect and record undesired incidents on interfering normal operations of PLCs. In order to prove the feasibility of their CPLCD solution, authors set up two experiments for detecting two common PLC attacks.and illustrate the advantages of using a network traffic analyzer such as wireshark in tandem with CPLCD for performing digital forensic investigation on PLCs.

In~\cite{basnight2013firmware} authors note that current efforts to protect PLCs against firmware attacks are hindered by a lack of prerequisite research regarding details of attack development and implementation. In their effort, authors address threats posed by PLC firmware counterfeiting and the feasibility of such attacks, this research explores the vulnerability of common controllers to intentional firmware modifications. In particular,  this work derives the firmware update validation method used for the Allen-Bradley ControlLogix PLC. Through a proof-of-concept, authors demonstrate how to alter a legitimate firmware update and successfully upload it to a ControlLogix L61. Subsequently, they present possible mitigation strategies which includes digitally signed and encrypted firmware as well as preemptive and post-mortem analysis methods to provide protection. Authors conclude their work noting that their work will motivate future research in PLC firmware security through direct example of firmware counterfeiting.

In~\cite{taveras2013scada} authors create a high level software application capable of detecting critical situations like abnormal changes of sensor reads, illegal penetrations, failures, physical memory content and abnormal traffic over the communication channel in a SCADA environment. A key challenges authors are faced is to minimize the impact of the tool on the SCADA resources, during the data acquisition process.

Authors in~\cite{eden2015forensic} provide an overall forensic taxonomy of the SCADA system incident response model. The proposed taxanomy model discusses the development of forensic readiness within SCADA system investigations, including the challenges faced by the SCADA forensic investigator and suggests ways in which the process may be improved.

In~\cite{wu2015exploring}, authors explore the problem of acquiring program code from PLCs under two hypotheses -- \textit{1) Program code is an important forensic artefact that can be used to determine an attacker's intentions;} and \textit{2) PLC debugging tools can be used for forensics to facilitate the acquisition and analysis of the program code from PLCs.} Based on the experiments conducted using tools from NIST CFTT, the results rejected the second hypothesis since their tool -- PLC Logger -- had failed half of the tests. With this, authors conclude that the PLC Logger in its current state has limited suitability as a forensic tool. To be accepted as a forensically sound tool, the shortcomings have to be addressed.

In~\cite{ahmed2012scada}, 



In~\cite{stirland2014developing}, 


In~\cite{van2014control}, 



\section{Preliminaries}\label{sec:rw}
MCS Vulnerabilities can be broadly categorized into the following two groups -- \textit{Platform Specific Vulnerabilities} and \textit{Network Specific Vulnerabilities}.

\subsection{Live Forensics}
Live forensics remedies some of the problems introduced by traditional forensic acquisition by performing analysis on a live system. Live forensics evolved as a sub-discipline in response to the shortcomings of dead forensic acquisition. A key feature of live forensics is its ability to retrieve volatile information which would be absent from static or deadbox forensics. It is also useful in limiting acquired data to information relevant to the incident under investigation. The objective of both static and live forensics is the same -- to find evidentiary data in support of the hypothesis. Consequently, the only differentiator is that the artifacts are being discovered on a live running system against an active adversary in case of of live forensics\footnote{$https://www.symantec.com/connect/blogs/live-response-vs-traditional-forensics-0$}.

Live forensics also supports analysis of processes, events, actions, and the likes that are questionable and potential early indicators of an impending attack. Therefore, with appropriate live forensics tools and techniques, the analyst remotely examine running processes, dump physical memory, examine running services, etc. and  determine if the situation warrants an in-depth analysis of that system. Unlike dead box forensics wherein the analyst has to be on site to acquire the evidence drives, live forensics can be performed remotely, which is not only convenient but also saves a lot of time due to false positives.

\subsection{Fieldbus -- A Review}\
Fieldbus is the name of a family of industrial computer network protocols used for real-time distributed control, standardized as IEC 61158\footnote{$https://en.wikipedia.org/wiki/Fieldbus$}. Fieldbus works on a network structure which typically allows daisy-chain, star, ring, branch, and tree network topologies.

\subsubsection{PROFIBUS -- \underline{PRO}cess \underline{FI}eld \underline{BUS} Protocol}
Process Field Bus -- PROFIBUS -- is a standard for fieldbus communication in automation technology and used by Siemens. PROFIBUS is standardized in IEC 61158 and is the world's most successful fieldbus with 53.7 million devices installed by the end of 2015. Utilizing a single, standardized, application-independent communication protocol, PROFIBUS supports fieldbus solutions both in factory and process automation as well as in motion control and safety-related tasks. The fieldbus protocol that Siemens and other manufacturers in Europe developed evolved into present day PROFIBUS protocol.

\subsection{The Modbus Protocol -- A Review}
Modbus is a protocol for serial communication using either the RS-232 standard or the RS-485 standard. Modbus allows for one master device to communicate with many slave devices. Since only one slave device can communicate with the master device at any given moment, all communication must be initiated by the master device. In SCADA systems, this means that the RTUs and PLCs (slave devices) operate mostly autonomously, except when the supervisory system (master device) issues a command or requests telemetry data.

\emph{Modbus Packet Structure} The Modbus TCP protocol uses a data structure called the Application Data Unit (ADU) to transmit data at the Application Layer. Each Modbus TCP ADU is composed of a Modbus Application (MBAP) header followed by a Modbus TCP Protocol Data Unit (PDU). The MBAP header contains five data fields for a total size of seven bytes. The first field is a two-byte  transaction ID, followed by a two-byte protocol ID field.  

The third data field is a two-byte message length field which specifies the Modbus PDU size in bytes, and the MBAP header ends with a one-byte Unit ID field. The Modbus TCP PDU contains two fields for a total size varying between $4$ - $65535$ bytes. The first PDU entry is a \emph{one-byte function code} that represents the function of the request or response, followed by a \emph{variable length data field}. It is the data field that holds the actual payload for the corresponding request/response message.

\subsection{MCS Operational Environment Challenges and Limitations}
Below is a list of challenges and constraints in designing and developing tools and techniques to support live forensics in SCADA-MCS environment.

\subsubsection{Hardware Platform Limitations} The three most popular HW ARCs for embedded components of MCS such as RTU and PLC are ``ARM'', ``PPC'', and ``$x86/x64$''. However, $x86/x64$ is out numbered by ARM and PPC by a significant margin. While open-source memory forensics frameworks such a Volatility and Linux do provide support for ARM and PPC, they are primarily built around $x86/x64$ systems. This is due to the enormous market share of Desktops/PCs.

\subsubsection{Software Platform Limitations} Majority of networked components for SCADA run on legacy platforms with extremely small quantities of physical memory. Consequently, they have little room for natively expanding their capabilities to support augmented logging for IR and forensics analysis.

\subsubsection{Lack of Standards and API Definitions} There is very limited information about the SCADA MCS architecture and system APIs available for building enhanced plug-in tools to support out-of-band processing to support forensics.

\subsubsection{Proprietary Solutions} Proprietary tools have limited capabilities and economically infeasible. Furthermore, proprietary tools often tend to be tailored for very specific tasks and platforms. Such lack of flexibility is very concerning given the evolving and volatile state of cyber-attacks. Existing proprietary and open-source tools with live forensics capabilities are prohibitive from a resource standpoint -- massive memory footprint and significant IO bound operations topping the list of resource concerns.

\subsubsection{Ready Adoption Challenges} Adoption of custom open-source tools ``as-is'' can present significant challenges with regards to legal and regulatory requirements. Porting necessary requirements for cyberforensics of SCADA system components into existing open-source tools warrants significant effort. 

\subsubsection{High Degree of Proprietary Solutions and Heterogeneity} Not only are the solutions proprietary in nature due to the unique domain requirement of each and every control systems environment, but also there degree of heterogeneity among field devices even within the same domain is significant to have a ``one-size-fits-all'' solution. Such proprietary solutions with such heterogeneity will make live forensics extremely challenging some of which are as follows -- network constraints due to OEM restrictions, node/device constraints€“ due to variations in HW/SW, communications security €“due to legacy and resource constrained devices and proprietary protocols, and the likes.

State-of-the-art tools with live forensics capabilities primarily include \textit{Volatility} and \textit{Rekall}. Both this frameworks currently provide very limited support for ARM and PowerPC (PPC) memory architectures, since they have been primarily developed around the x86 systems. While it is possible to expand either of these frameworks to support live forensics on MCS systems, it is significant effort to write a plugin/LKM for ARM/PPC memory architectures taking into considerations the subtle variations implemented by vendors creating proprietary memory architecture. 



\section{Prototype Model}\label{sec:sys-model}
We utilize two vastly different methods -- Memory Analysis and Traffic Analysis. There two approaches have different purposes with regards to security and forensics analysis. However, the two methods can be coulped to work complimenting each other. Such a hybrid platform will enable robust security and forensics analysis. The open systems architecture prototype framework will use the following open source tools along with numerous custom tools.
\begin{figure}[!t]
\includegraphics[scale=0.25]{figures/kraft-arch.eps}
\caption{Open Systems Architecture prototype supporting memory dump and fieldbus traffic analysis.}
\label{fig:protot-arch}
\end{figure}

\begin{itemize}
\item \textbf{LiME (Linux Memory Extractor).} LiME is an open source loadable kernel module that can acquire live memory from popular processor architectures -- x86/x64, PPC, and ARM. Furthermore, LiME can extract the live memory in three different formats -- .lime, .raw, . Compatible with desktop Linux distributions and Android. Does not include any tools to analyze the images it collects.

\item \textbf{Bulk Extractor.} This is an open source file system forensics analysis tool suite. Unlike, LiME, bulk extractor is not capable of acquiring live memory. Furthermore, bulk extractor is also not capable of extracting process level information from a memory dump. However, the tool can scan memory dump images for certain types of forensically relevant information such as -- IP address, Network sockets, Credit card numbers, URLs, Passwords, and Encryption keys. While the tool evidently has limitations in processing live memory, its limited capabilities are very useful in correlating live memory information and raw packet capture providing a unique purview during security and forensics analysis.
\end{itemize}

\section{Validation Model}\label{sec:eval}
\begin{table*}[!ht]
\scriptsize
\begin{center}
\begin{tabular}{p{4.3cm}p{6.3cm}p{6.6cm}}\toprule
\textbf{Open Source Tools}	&	\textbf{Capabilities}	&	\textbf{Limitations}	\\\toprule
\textbf{Rekall Memory Forensics Framework}	&	A computer forensics tool that scans a memory dump image or virtual machine snapshot and extracts useful information 	&	Requires a ``profile'' (aka config file) to analyze images of systems with address spaces that aren't included in its releases  	\\\\
&	Includes a toolkit for acquiring memory dumps on Windows, Linux, and OSX systems  &	Generating profiles requires compiling Rekall provided kernel module \\\\
	&	Can be used either as a standalone application or as a scripting library to automate memory analysis  	&	Analysis capabilities are primarily limited to x86/amd64 systems	\\\midrule
	
\textbf{Volatility Memory Forensics Framework}	&	Functionality can be extended with plugins and address space profiles	 &  Volatility is not capable of acquiring memory dumps -- it is dependent on other tools like LiME\\\\
	&	Forensics tool-suite that scans and extracts information from memory dump images of Win, OSX, Linux, \& Android systems &	  Framework's profile subsystem has compatibility limitations similar to that of Rekall\\\\
	&	&	Compatible with ARM systems, primarily Android, does not carry over to other embedded ARM systems running desktop Linux \\\midrule
	
	
	
\textbf{Volatilitux}	&	Released in 2010 to add Linux compatibility in Volatility 	&	Not actively updated since 2010, and has limited support for Linux Kernel beyond 2.6.x	\\\\
	&		Has compatibility with ARM-based desktop Linux distributions &	Compatibile only with images captured using Volatilitux	\\\\
	&		&	Very limited analysis capability -- only 5 commands available	\\\midrule
	
	
\textbf{LiME (Linux Memory Extractor)}	&	Linux LKM capable of acquiring memory dump in several different formats -- ``.lime'', ``.raw'', and ``padded''	&	 Lacks memory dump processing and analysis capability	\\\\
	&	Compatible with desktop Linux distributions and Android	&		\\\midrule
	
	
\textbf{Dumpchk.exe}	& Microsoft freeware for validating Windows memory dumps 	&	Only supports Windows memory dumps	\\\\

	&	Limited capability of parsing certain types of metadata from memory dumps 	&	Proprietary and non-extensible	\\
	&		&		\\\midrule
	
	
\textbf{Autopsy/	The Sleuth Kit (TSK)} &	Disk forensics analysis tool	capable of handling numerous file system types for disk analysis &	Does not support memory acquisition or memory analysis\\\\\midrule
	
	
\textbf{Bulk Extractor}	&	Disk forensics analysis tool	&	Can only process acquired memory images for network connection, registry keys, sockets, etc.	\\\\

	&	Capable of analyzing disk images for certain types of forensically relevant information (phone, CC numbers, URLs, etc.)	 &	Does not support memory analysis at process level unlike Volatility or Rekall	\\\bottomrule
\end{tabular}
\vspace{3mm}
\caption{Summary of capabilities and limitations of open-source forensics tools that support live forensics both directly and indirectly.}
\label{tab:tools}
\end{center}
\end{table*}

\subsection{Validation Framework}
We conduct some testing on Rekall's WinPMem tool to determine how different operational parameters affect the time and storage space it requires to capture memory dumps. Our tests included:
\begin{enumerate}
\item Capturing memory dumps of the same system with different amounts of system memory installed, and recording the time and storage overhead for each.  
\item Capturing memory dumps using different file compression options: the snappy algorithm, the zlib algorithm, and no compression.  Although Rekall?s website claims that snappy compression is the fastest option, we found that storing the files in uncompressed form was often slightly faster on the machine we used.  
\item Observing WinPMem's behavior when we try to append a new memory dump to an existing one. This is the default behavior for when the specified output file already exists.
\end{enumerate}


\subsection{Transmitting memory dumps via Modbus TCP}
From number of bytes (2) in the message length field, we conclude that each Modbus TCP frame can hold a payload up to 65535 bytes in size. Since very few embedded systems with system memory of 64 KB or less are still in use, any implementation of memory dump transmission via Modbus TCP should be designed to accommodate file splitting on the server side and file splicing on the client side. Table 1 shows how different sizes of memory dump would be split for transmission:

\subsubsection{Packet Crafting Module}
We have implemented a custom kernel module that is a packet crafter such that the memory dump can be packaged into into independent data packets and/or embedded into unused bits of data packets exchanged between the field device and the MTU over the course of several request/response messages.

%\begin{table}[!h]
%\begin{center}
%\begin{tabular}{lll}\toprule
%RAM size (KB) 	&	Frames Required w/o Hash	&	Frames Required with hash\\\toprule
%256	&	4	&	4	\\
%512	&	8	&	8	\\
%64000	&	977	&	977	\\
%256000	&	3907	&	3907	\\\bottomrule
%\end{tabular}
%\caption{Overhead associated with shipping back the RTU/PLC memory dump to the MTU.}
%\label{tab:frames-req}
%\end{center}
%\end{table}

\section{Validation Results}\label{sec:results}

\begin{table*}[!htbp]
\begin{center}
\begin{tabular}{lllllll}\toprule
	&	\textbf{zlib}	&	\textbf{zlib with}	&	\textbf{snappy}	&	\textbf{snappy with}	&	\textbf{No compression} &	\textbf{No compression}	\\
		&		&	\textbf{truncation}	&	&	\textbf{truncation}	&	\textbf{No truncation} &	\textbf{with truncation}	\\\toprule
\textbf{Total runtime (s)}	&	451.15	&	435.10	&	329.14	&	349.02	&	311.57	&	309.72	\\\\
%\textbf{Memdump size (B)}	&	5,347,984,723	&	5,440,281,251	&	5,024,617,223	&	5,920,743,621	&	8,564,930,530	&	8,564,930,531	\\\\
%\textbf{Size of Memdump (KiB)}	&	5222641.33	&	5312774.66	&	4906852.76	&	5781976.19	&	8364189.97	&	8364189.97	\\\\
%\textbf{Memdump size(KB)}	&	5347984.723	&	5440281.251	&	5024617.223	&	5920743.621	&	8564930.53	&	8564930.531	\\\\
\textbf{Size of Memdump (MiB)}	&	5100.24	&	5188.26	&	4791.85	&	5646.46	&	8168.15	&	8168.15	\\\bottomrule
%\textbf{Memdump size (MB)}	&	5347.984723	&	5440.281251	&	5024.617223	&	5920.743621	&	8564.93053	&	8564.930531	\\
\end{tabular}
\vspace{3mm}
\caption{Compression time and size on Raspberry PI 3.}
\label{tab:compression-truncation}
\end{center}
\end{table*}


\subsection{Observations}
\begin{itemize}
\item Winpmem provided by Rekall is expected to either append a complete memory dump to the existing one and double its size, or to append a subset of the address space that had changed since the acquisition of the previous dump. Instead, the program returned an error. While we have every intention to investigate this further, for the work presented paper, we dont have additional information.

\item Rekall has a small but powerful suite of built-in plugins to analyze Windows registry entries.  In this example, we will use them to find and display registry key pairs contained in our memory dump.  With our image file open in Rekall, we begin by calling the hives plugin.
\end{itemize}


\subsection{Results}

\subsection{Secure Memory Dump Transfer to MTU}
Protecting the data against corruption and truncation would require additional measures. Two possibilities exist to alert the client to any errors in data transmission or splicing:

\begin{enumerate}
\item Transmit a single checksum for the entire memory dump, and verify the integrity of the reassembled dump-file at the MTU.This would require very little overhead. The comparison in Table~\ref{tab:frames-req} shows that for several common RAM configurations, packaging a checksum from the Linux command sha256sum with the memory dump requires no extra packets to be sent. Only one checksum of the memory dump file would be necessary because TCP already performs checksum-based verification of each packet. The only concerning aspect of this method is its potential to become too complex, in terms of computation and disk access, to be feasible on an embedded system.
\item Overlap the transmissions such that each fragment is transmitted with a small amount of data
from the previous fragment. This method would decrease the complexity of disk and computational operations, but transmission overhead would increase proportionally to the size of the overlap.
\end{enumerate}


\section{Conclusion and Future Work}\label{sec:conc}

\section{Definitions}
\begin{myDef}
Cyber-Physical Systems are co-engineered interacting networks of physical and computational components that are built from, and depend upon, the seamless integration of computational algorithms and physical components.
\end{myDef}

\begin{myDef}
Control Systems manage, command, direct or regulate the behaviour of other devices or systems ranging from a home  a thermostat controlling a domestic boiler to large industrial control systems which are used for controlling processes or machines.
\end{myDef}

\begin{myDef}
Industrial control system (ICS) is a general term that encompasses several types of control systems and associated instrumentation used in industrial production, including supervisory control and data acquisition (SCADA) systems, distributed control systems (DCS), and other smaller control system configurations such as programmable logic controllers (PLC) often found in the industrial sectors and critical infrastructures.
\end{myDef}


\begin{myDef}
A programmable logic controller (PLC), or programmable controller is an industrial digital computer which has been ruggedised and adapted for the control of manufacturing processes, such as assembly lines, or robotic devices, or any activity that requires high reliability control and ease of programming and process fault diagnosis.
\end{myDef}

\balance
\begin{myDef}
Supervisory control and data acquisition (SCADA) is a control system architecture that uses computers, networked data communications and graphical user interfaces for high-level process supervisory management, but uses other peripheral devices such as programmable logic controllers and discrete PID controllers to interface to the process plant or machinery.
\end{myDef}

\begin{myDef}
A remote terminal unit (RTU) is a microprocessor-controlled electronic device that interfaces objects in the physical world to a distributed control system or SCADA (supervisory control and data acquisition) system by transmitting telemetry data to a master system, and by using messages from the master supervisory system to control connected objects.
\end{myDef}

\begin{myDef}
A Distributed Control System (DCS) is a computerised control system for a process or plant, in which autonomous controllers are distributed throughout the system, but there is central operator supervisory control.
\end{myDef}

\begin{myDef}
A loadable kernel module (LKM) is an object file that contains code to extend the running kernel (aka base kerne) of an operating system typically used to add support for new hardware (as device drivers) and/or filesystems, or for adding system calls to provide additional functionality.
\end{myDef}

\begin{myDef}
Advanced RISC Machine (ARM) is a family of reduced instruction set computing (RISC) architectures for computer processors, configured for various environments. ARM has reduces costs, heat and power use making it highly desirable for embedded systems in SCADA-MCS environment.
\end{myDef}

\bibliographystyle{plain}
    \bibliography{scada-live-forensics.bib}
\end{document}


